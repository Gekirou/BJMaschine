package de.cfc.bjm.data;

import java.util.HashMap;

import android.content.Context;
import android.database.Cursor;
import android.view.LayoutInflater;
import android.view.View;
import android.widget.LinearLayout;
import android.widget.SimpleCursorAdapter;
import android.widget.TextView;
import de.cfc.bjm.R;

public class BLCursorAdapter extends SimpleCursorAdapter {
	
	LayoutInflater inflater ;
	int position=1;
	boolean saufmode;
	
	public BLCursorAdapter(Context context, int layout, Cursor c,
			String[] from, int[] to) {
		super(context, layout, c, from, to);
		
		inflater = LayoutInflater.from(context);
		DataHolder.rankIdMap= new HashMap<Integer, Integer>();
	}
	
	public BLCursorAdapter( Context context,int position, int layout, Cursor c,
			String[] from, int[] to) {
		super(context, layout, c, from, to);
		this.position = position;
		inflater = LayoutInflater.from(context);
		DataHolder.rankIdMap= new HashMap<Integer, Integer>();
		saufmode=true;

	}


	@Override
	public void bindView(View view, Context context, Cursor cursor) {
		super.bindView(view, context,cursor);
		
		int offset;
		TextView lid = (TextView) view.findViewById(R.id.rangzahl);
		DataHolder.rankIdMap.put(cursor.getPosition()+1, cursor.getInt(0));

		if(position < 15){
			offset = position-1;
		}else{
			offset = 15;
		}
		lid.setText((cursor.getPosition() + position - offset)+"");
		
		TextView name = (TextView) view.findViewById(R.id.name_entry);
		name.setText(cursor.getString(1));
		
		TextView dur = (TextView) view.findViewById(R.id.duration_entry);
		
		String mseconds;
		int sec = cursor.getInt(2)/1000;
		int msec = (cursor.getInt(2)-(sec*1000));
		if(msec<10){
		   mseconds ="00"+msec;
		}else{
			if(msec<100){
			   mseconds="0"+msec;
			} else{
				mseconds = ""+msec;
			}
		}
		
		dur.setText(sec+"."+mseconds);
		if(saufmode){
			LinearLayout bestLinLay = (LinearLayout) view.findViewById(R.id.bestlistlinlay);

		if(cursor.getInt(0)== DataHolder.lid ){

			bestLinLay.setBackgroundResource(R.color.green);
		}else{ if(cursor.getInt(0) == DataHolder.lid2nd){
			bestLinLay.setBackgroundResource(R.color.light_grey);
		}else{
			bestLinLay.setBackgroundResource(R.color.white);
		}
		}}
		
		
	}

}
